<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Earth's Firewall - Asteroid Impact Simulator</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/controls.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/visualizations.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/responsive.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/navigation.css') }}">
    <style>
        /* Beautiful twinkling starfield background */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(2px 2px at 20% 10%, #ffffff, transparent 60%),
                radial-gradient(1.5px 1.5px at 80% 30%, #9cc7ff, transparent 60%),
                radial-gradient(1.8px 1.8px at 60% 80%, #ffffff, transparent 60%),
                radial-gradient(1.2px 1.2px at 30% 60%, #8db7ff, transparent 60%),
                radial-gradient(1px 1px at 40% 20%, #ffffff, transparent 50%),
                radial-gradient(1.5px 1.5px at 70% 70%, #a8c8ff, transparent 60%),
                radial-gradient(1px 1px at 90% 40%, #ffffff, transparent 50%),
                radial-gradient(1.3px 1.3px at 10% 80%, #9cc7ff, transparent 60%),
                radial-gradient(1px 1px at 50% 50%, #ffffff, transparent 50%),
                radial-gradient(1.4px 1.4px at 15% 60%, #8db7ff, transparent 60%);
            background-repeat: no-repeat;
            background-size: 100% 100%;
            animation: twinkle 8s ease-in-out infinite;
            z-index: -1;
            opacity: 0.6;
        }
        
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(1px 1px at 25% 15%, #ffffff, transparent 50%),
                radial-gradient(1.2px 1.2px at 75% 25%, #a8c8ff, transparent 60%),
                radial-gradient(0.8px 0.8px at 45% 85%, #ffffff, transparent 50%),
                radial-gradient(1.1px 1.1px at 85% 45%, #9cc7ff, transparent 60%),
                radial-gradient(0.9px 0.9px at 35% 35%, #ffffff, transparent 50%),
                radial-gradient(1.3px 1.3px at 65% 65%, #8db7ff, transparent 60%);
            background-repeat: no-repeat;
            background-size: 100% 100%;
            animation: twinkle 12s ease-in-out infinite reverse;
            z-index: -1;
            opacity: 0.4;
        }
        
        @keyframes twinkle {
            0%, 100% { opacity: 0.3; }
            25% { opacity: 0.8; }
            50% { opacity: 0.4; }
            75% { opacity: 0.9; }
        }
    </style>
    <!-- Three.js CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <!-- D3.js CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <h1>Earth's Firewall</h1>
            </div>
            <div class="nav-menu">
                <a href="/" class="nav-link active">Home</a>
                <a href="/simulation" class="nav-link">Simulation</a>
                <a href="/information" class="nav-link">Information</a>
                <a href="/tutorial" class="nav-link">Tutorial</a>
            </div>
            <div class="nav-toggle">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main">
        <!-- LEFT: 3D Visualization -->
        <section class="panel panel--left" role="main" aria-label="3D Earth Visualization">
            <header class="panel__header">
                <h2 class="panel__title">Earth Defense System</h2>
            </header>
            
            <div class="visualization-container">
                <div id="asteroid-belt-zone" class="asteroid-belt-zone">
                    <canvas id="earthCanvas"></canvas>
                </div>
            </div>
        </section>

        <!-- CENTER: Mission Control -->
        <section class="panel panel--center" role="complementary" aria-label="Mission Control">
            <header class="panel__header">
                <h2 class="panel__title">Mission Control</h2>
            </header>

            <section class="section" aria-labelledby="asteroid-selection-title">
                <h3 id="asteroid-selection-title" class="section__title">Asteroid Selection</h3>
                <div class="control-group">
                    <label for="asteroid-select" class="control-label">Threat Level</label>
                    <select id="asteroid-select" class="control-select">
                        <option value="impactor-2025">Impactor-2025 (NASA Threat)</option>
                        <option value="custom">Custom Asteroid</option>
                        <option value="apophis">Apophis (99942)</option>
                        <option value="bennu">Bennu (101955)</option>
                    </select>
                </div>
            </section>

            <section class="section" aria-labelledby="impact-parameters-title">
                <h3 id="impact-parameters-title" class="section__title">Impact Parameters</h3>
                <div class="control-group">
                    <label for="diameter-slider" class="control-label">Diameter: <span id="diameter-value">0.5 km</span></label>
                    <input type="range" id="diameter-slider" class="control-slider" min="0.1" max="10" step="0.1" value="0.5">
                </div>
                <div class="control-group">
                    <label for="velocity-slider" class="control-label">Velocity: <span id="velocity-value">15.2 km/s</span></label>
                    <input type="range" id="velocity-slider" class="control-slider" min="5" max="50" step="0.1" value="15.2">
                </div>
                <div class="control-group">
                    <label for="angle-slider" class="control-label">Impact Angle: <span id="angle-value">45Â°</span></label>
                    <input type="range" id="angle-slider" class="control-slider" min="0" max="90" step="1" value="45">
                </div>
            </section>

            <section class="section" aria-labelledby="defense-strategy-title">
                <h3 id="defense-strategy-title" class="section__title">Defense Strategy</h3>
                <div class="control-group">
                    <label for="strategy-select" class="control-label">Defense Method</label>
                    <select id="strategy-select" class="control-select">
                        <option value="kinetic">Kinetic Impactor</option>
                        <option value="gravity">Gravity Tractor</option>
                        <option value="laser">Laser Ablation</option>
                    </select>
                </div>
            </section>

            <section class="section">
                <div class="action-buttons">
                    <button id="simulate-btn" class="btn btn--primary">Simulate Impact</button>
                    <button id="deflect-btn" class="btn btn--secondary">Test Deflection</button>
                    <button id="game-btn" class="btn btn--success">Defend Earth!</button>
                </div>
            </section>
        </section>

        <!-- RIGHT: Mission Data / Insights -->
        <aside class="panel panel--right" role="complementary" aria-label="Mission Data">
            <header class="panel__header">
                <h2 class="panel__title">Mission Data</h2>
            </header>

            <section class="section" aria-labelledby="asteroid-details-title">
                <h3 id="asteroid-details-title" class="section__title">Asteroid Details</h3>
                <dl class="info-grid">
                    <div class="info"><dt class="info__label">Name</dt><dd id="asteroid-name" class="info__value">Impactor-2025</dd></div>
                    <div class="info"><dt class="info__label">Diameter</dt><dd id="asteroid-diameter" class="info__value">0.5 km</dd></div>
                    <div class="info"><dt class="info__label">Velocity</dt><dd id="asteroid-velocity" class="info__value">15.2 km/s</dd></div>
                    <div class="info"><dt class="info__label">Mass</dt><dd id="asteroid-mass" class="info__value">1.2e12 kg</dd></div>
                </dl>
            </section>

            <section class="section" aria-labelledby="impact-analysis-title">
                <h3 id="impact-analysis-title" class="section__title">Impact Analysis</h3>
                <dl class="zones">
                    <div class="zone zone--total"><dt class="zone__label">Total Destruction</dt><dd id="zone-total" class="zone__value">5.2 km</dd></div>
                    <div class="zone zone--severe"><dt class="zone__label">Severe Damage</dt><dd id="zone-severe" class="zone__value">15.8 km</dd></div>
                    <div class="zone zone--moderate"><dt class="zone__label">Moderate Damage</dt><dd id="zone-moderate" class="zone__value">45.2 km</dd></div>
                </dl>
            </section>

            <section class="section" aria-labelledby="environmental-effects-title">
                <h3 id="environmental-effects-title" class="section__title">Environmental Effects</h3>
                <ul class="effects">
                    <li class="effect">Tsunami Risk: <strong id="tsunami-risk">High</strong></li>
                    <li class="effect">Seismic: <strong id="seismic-magnitude">6.2 Richter</strong></li>
                    <li class="effect">Atmospheric: <strong id="atmospheric-effect">Dust Cloud</strong></li>
                </ul>
            </section>

            <section class="section is-hidden" id="deflection-results" aria-labelledby="defense-results-title" aria-live="polite">
                <h3 id="defense-results-title" class="section__title">Defense Results</h3>
                <dl class="status">
                    <div class="status__row"><dt class="status__label">Deflection Success</dt><dd id="deflection-success" class="status__value status__value--ok">85%</dd></div>
                    <div class="status__row"><dt class="status__label">New Miss Distance</dt><dd id="miss-distance" class="status__value">12,500 km</dd></div>
                    <div class="status__row"><dt class="status__label">Time to Impact</dt><dd id="time-to-impact" class="status__value">2.3 days</dd></div>
                </dl>
            </section>
        </aside>
    </main>

    <!-- Game Mode Overlay -->
    <section class="overlay overlay--game is-hidden" id="game-overlay" aria-hidden="true" aria-label="Defend Earth Challenge">
        <header class="overlay__header">
            <h2 class="overlay__title">Defend Earth Challenge</h2>
            <div class="game-metrics">
                <div class="metric"><span class="metric__label">Score</span><span id="game-score" class="metric__value">0</span></div>
                <div class="metric"><span class="metric__label">Level</span><span id="game-level" class="metric__value">1</span></div>
                <div class="metric"><span class="metric__label">Time</span><span id="game-time" class="metric__value">60s</span></div>
            </div>
        </header>
        <div class="overlay__actions">
            <button id="start-game" class="btn btn--success" type="button">Start Mission</button>
            <button id="exit-game" class="btn btn--secondary" type="button">Exit</button>
        </div>
    </section>

    <!-- Loading Screen -->
    <section class="overlay overlay--loading" id="loading-screen" aria-live="polite" aria-busy="true">
        <div class="loading">
            <div class="loading__spinner" aria-hidden="true"></div>
            <h3 class="loading__title">Initializing Earth's Firewallâ¦</h3>
            <p class="loading__subtitle">Loading asteroid data and 3D modelsâ¦</p>
        </div>
    </section>

    <!-- App Scripts -->
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
    <script src="{{ url_for('static', filename='js/api-client.js') }}"></script>
    <script src="{{ url_for('static', filename='js/visualization/scene-setup.js') }}"></script>
    <script src="{{ url_for('static', filename='js/visualization/earth-model.js') }}"></script>
    <script src="{{ url_for('static', filename='js/visualization/asteroid-model.js') }}"></script>
    <script src="{{ url_for('static', filename='js/simulation/simulation-engine.js') }}"></script>
    <script src="{{ url_for('static', filename='js/ui/controls.js') }}"></script>
    <script src="{{ url_for('static', filename='js/ui/game-mode.js') }}"></script>
    <script src="{{ url_for('static', filename='js/gliding-scroll.js') }}"></script>
    <script src="{{ url_for('static', filename='js/navigation.js') }}"></script>
</body>
</html>